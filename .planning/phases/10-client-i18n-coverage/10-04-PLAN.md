---
phase: 10-client-i18n-coverage
plan: 04
type: execute
wave: 4
depends_on: ["10-03"]
files_modified:
  - client/src/pages/Integrations.tsx
  - client/src/components/CalendarWidget.tsx
  - client/src/components/IdeaRefinement.tsx
  - client/src/i18n/locales/en.json
  - client/src/i18n/locales/de.json
autonomous: true

must_haves:
  truths:
    - "Integrations page title, loading text, connection card status/buttons, search section, Gmail inbox section, and Calendar section all appear in German when language is DE"
    - "CalendarWidget heading, empty state, badge labels (Linked, Upcoming), attendee text, and link-to-project UI appear in German when language is DE"
    - "IdeaRefinement readiness labels, threshold/rounds info, AI question/answer UI, assessment results, override button, and status messages appear in German when language is DE"
  artifacts:
    - path: "client/src/pages/Integrations.tsx"
      provides: "i18n-enabled Integrations page"
      contains: "useLanguage"
    - path: "client/src/components/CalendarWidget.tsx"
      provides: "i18n-enabled calendar widget"
      contains: "useLanguage"
    - path: "client/src/components/IdeaRefinement.tsx"
      provides: "i18n-enabled idea refinement component"
      contains: "useLanguage"
    - path: "client/src/i18n/locales/en.json"
      provides: "English keys for integrations, calendar, ideaRefinement namespaces"
    - path: "client/src/i18n/locales/de.json"
      provides: "German keys for integrations, calendar, ideaRefinement namespaces"
  key_links:
    - from: "client/src/pages/Integrations.tsx"
      to: "en.json/de.json"
      via: "t() calls"
      pattern: "t\\(\"integrations\\."
    - from: "client/src/components/CalendarWidget.tsx"
      to: "en.json/de.json"
      via: "t() calls"
      pattern: "t\\(\"calendar\\."
    - from: "client/src/components/IdeaRefinement.tsx"
      to: "en.json/de.json"
      via: "t() calls"
      pattern: "t\\(\"ideaRefinement\\."
---

<objective>
Internationalize the Integrations page (with CalendarWidget sub-component) and IdeaRefinement component.

Purpose: The Integrations page is the largest single file requiring i18n (~42 keys across connection cards, search, Gmail inbox, and calendar). IdeaRefinement has complex AI interaction UI with ~17 keys. Together these cover requirements I18N-02 and I18N-06, completing Phase 10.

Output: Three files fully i18n-enabled + ~59 new keys in both en.json and de.json.
</objective>

<execution_context>
@/Users/developer/.claude/get-shit-done/workflows/execute-plan.md
@/Users/developer/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-client-i18n-coverage/10-03-SUMMARY.md
@client/src/hooks/useLanguage.ts
@client/src/i18n/locales/en.json
@client/src/i18n/locales/de.json
@client/src/pages/Integrations.tsx
@client/src/components/CalendarWidget.tsx
@client/src/components/IdeaRefinement.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add translation keys for Integrations, CalendarWidget, and IdeaRefinement to both locale files</name>
  <files>client/src/i18n/locales/en.json, client/src/i18n/locales/de.json</files>
  <action>
Add three new top-level namespaces to both en.json and de.json. Both files must be updated in the same commit.

**en.json — add `"integrations"` namespace:**
```json
"integrations": {
  "title": "Integrations",
  "loading": "Loading integration status...",
  "status_connected": "Connected",
  "status_not_connected": "Not connected",
  "connecting": "Connecting...",
  "disconnecting": "Disconnecting...",
  "disconnect": "Disconnect",
  "connect_google": "Connect Google",
  "connect_github": "Connect GitHub",
  "provider_google": "Google (Gmail)",
  "provider_github": "GitHub",
  "google_connected_detail": "Connected{{email}} as {{email}}{{since}} since {{since}}",
  "google_disconnected_detail": "Connect Google to sync Gmail messages, route emails to projects, and draft replies.",
  "github_connected_detail": "Connected{{username}} as @{{username}}{{since}} since {{since}}",
  "github_disconnected_detail": "Connect GitHub to link repositories, view commits and PRs, and run code analysis.",
  "search_title": "AI Search",
  "search_description": "Search across projects, ideas, and soul documents using AI.",
  "search_no_team": "Create a team to use AI-powered search across your projects.",
  "search_placeholder": "Ask anything about your projects...",
  "search_scope_all": "All",
  "search_scope_projects": "Projects",
  "search_scope_ideas": "Ideas",
  "search_scope_soul_docs": "Soul Docs",
  "search_searching": "Searching...",
  "search_button": "Search",
  "search_answer": "Answer:",
  "search_sources": "Sources ({{count}}):",
  "gmail_title": "Gmail Inbox",
  "gmail_filter_placeholder": "Filter (e.g., is:unread, from:someone@example.com)",
  "gmail_fetch_loading": "Loading...",
  "gmail_fetch_button": "Fetch Messages",
  "gmail_empty": "No messages loaded. Click \"Fetch Messages\" to load your inbox.",
  "gmail_not_connected": "Connect your Google account above to view and manage Gmail messages.",
  "gmail_no_subject": "(no subject)",
  "calendar_title": "Calendar",
  "calendar_description": "View meetings from your Google Calendar and link them to projects.",
  "calendar_not_connected": "Connect your Google account above to view calendar meetings."
}
```

**en.json — add `"calendar"` namespace:**
```json
"calendar": {
  "title": "Calendar",
  "empty": "No meetings found.",
  "badge_linked": "Linked",
  "badge_upcoming": "Upcoming",
  "attendees": "{{count}} attendee",
  "attendees_plural": "{{count}} attendees",
  "link_to_project": "Link to project",
  "select_project": "Select project...",
  "cancel": "Cancel"
}
```

**en.json — add `"ideaRefinement"` namespace:**
```json
"ideaRefinement": {
  "readiness": "Readiness",
  "threshold": "Threshold: {{value}}",
  "rounds": "Rounds: {{current}}/{{max}}",
  "rounds_left": " ({{left}} left)",
  "ask_ai": "Ask AI for Refinement Question",
  "thinking": "Thinking...",
  "max_rounds": "Maximum refinement rounds reached ({{max}}).",
  "ai_question": "AI Question",
  "answer_placeholder": "Type your answer...",
  "hint_submit": "Cmd+Enter to submit",
  "submitting": "Submitting...",
  "submit_answer": "Submit Answer",
  "assessment_header": "Readiness Assessment: {{score}}/100",
  "missing_items": "Missing Items:",
  "override_button": "Mark as Ready (Override)",
  "overriding": "Overriding...",
  "status_info": "This idea is currently in {{status}} status.",
  "status_ready_hint": " It can now be proposed for graduation.",
  "status_voting_hint": " Team members are voting on graduation.",
  "status_graduated_hint": " This idea has been promoted to a project."
}
```

**de.json — add `"integrations"` namespace:**
```json
"integrations": {
  "title": "Integrationen",
  "loading": "Integrationsstatus wird geladen...",
  "status_connected": "Verbunden",
  "status_not_connected": "Nicht verbunden",
  "connecting": "Wird verbunden...",
  "disconnecting": "Wird getrennt...",
  "disconnect": "Trennen",
  "connect_google": "Google verbinden",
  "connect_github": "GitHub verbinden",
  "provider_google": "Google (Gmail)",
  "provider_github": "GitHub",
  "google_connected_detail": "Verbunden{{email}} als {{email}}{{since}} seit {{since}}",
  "google_disconnected_detail": "Google verbinden, um Gmail-Nachrichten zu synchronisieren, E-Mails an Projekte weiterzuleiten und Antworten zu entwerfen.",
  "github_connected_detail": "Verbunden{{username}} als @{{username}}{{since}} seit {{since}}",
  "github_disconnected_detail": "GitHub verbinden, um Repositories zu verknüpfen, Commits und PRs anzuzeigen und Code-Analysen durchzuführen.",
  "search_title": "KI-Suche",
  "search_description": "Durchsuche Projekte, Ideen und Soul Documents mit KI.",
  "search_no_team": "Erstelle ein Team, um die KI-gestützte Suche über deine Projekte zu nutzen.",
  "search_placeholder": "Frage zu deinen Projekten stellen...",
  "search_scope_all": "Alle",
  "search_scope_projects": "Projekte",
  "search_scope_ideas": "Ideen",
  "search_scope_soul_docs": "Soul Docs",
  "search_searching": "Suche läuft...",
  "search_button": "Suchen",
  "search_answer": "Antwort:",
  "search_sources": "Quellen ({{count}}):",
  "gmail_title": "Gmail-Posteingang",
  "gmail_filter_placeholder": "Filter (z.B. is:unread, from:name@beispiel.de)",
  "gmail_fetch_loading": "Wird geladen...",
  "gmail_fetch_button": "Nachrichten abrufen",
  "gmail_empty": "Keine Nachrichten geladen. Klicken Sie auf \"Nachrichten abrufen\", um Ihren Posteingang zu laden.",
  "gmail_not_connected": "Verbinden Sie Ihr Google-Konto oben, um Gmail-Nachrichten anzuzeigen und zu verwalten.",
  "gmail_no_subject": "(kein Betreff)",
  "calendar_title": "Kalender",
  "calendar_description": "Termine aus Ihrem Google Kalender anzeigen und mit Projekten verknüpfen.",
  "calendar_not_connected": "Verbinden Sie Ihr Google-Konto oben, um Kalendertermine anzuzeigen."
}
```

**de.json — add `"calendar"` namespace:**
```json
"calendar": {
  "title": "Kalender",
  "empty": "Keine Termine gefunden.",
  "badge_linked": "Verknüpft",
  "badge_upcoming": "Bevorstehend",
  "attendees": "{{count}} Teilnehmer",
  "attendees_plural": "{{count}} Teilnehmer",
  "link_to_project": "Mit Projekt verknüpfen",
  "select_project": "Projekt auswählen...",
  "cancel": "Abbrechen"
}
```

**de.json — add `"ideaRefinement"` namespace:**
```json
"ideaRefinement": {
  "readiness": "Bereitschaft",
  "threshold": "Schwellenwert: {{value}}",
  "rounds": "Runden: {{current}}/{{max}}",
  "rounds_left": " ({{left}} übrig)",
  "ask_ai": "KI nach Verfeinerungsfrage fragen",
  "thinking": "Denkt nach...",
  "max_rounds": "Maximale Verfeinerungsrunden erreicht ({{max}}).",
  "ai_question": "KI-Frage",
  "answer_placeholder": "Antwort eingeben...",
  "hint_submit": "Cmd+Enter zum Absenden",
  "submitting": "Wird gesendet...",
  "submit_answer": "Antwort absenden",
  "assessment_header": "Bereitschaftsbewertung: {{score}}/100",
  "missing_items": "Fehlende Punkte:",
  "override_button": "Als bereit markieren (Überschreibung)",
  "overriding": "Wird überschrieben...",
  "status_info": "Diese Idee befindet sich derzeit im Status {{status}}.",
  "status_ready_hint": " Sie kann jetzt zur Graduierung vorgeschlagen werden.",
  "status_voting_hint": " Teammitglieder stimmen über die Graduierung ab.",
  "status_graduated_hint": " Diese Idee wurde zu einem Projekt befördert."
}
```

IMPORTANT: German text must use proper Unicode umlauts. Translate full phrases. The connected_detail strings in integrations are complex — note that the Integrations page currently builds these with template literals and conditionals. The executor should build the detail string dynamically using t() with interpolation rather than concatenating. See Task 2 for exact wiring approach.
  </action>
  <verify>Run `node -e "const en = require('./client/src/i18n/locales/en.json'); const de = require('./client/src/i18n/locales/de.json'); ['integrations','calendar','ideaRefinement'].forEach(ns => console.log(ns, Object.keys(en[ns]).length, Object.keys(de[ns]).length));"` — all three namespaces exist with matching key counts.</verify>
  <done>en.json and de.json each contain integrations (~42 keys), calendar (~9 keys), and ideaRefinement (~17 keys) namespaces with matching key counts and proper German Unicode.</done>
</task>

<task type="auto">
  <name>Task 2: Wire useLanguage into Integrations, CalendarWidget, and IdeaRefinement</name>
  <files>client/src/pages/Integrations.tsx, client/src/components/CalendarWidget.tsx, client/src/components/IdeaRefinement.tsx</files>
  <action>
For each component, add the useLanguage import and replace hardcoded strings.

**Integrations.tsx (page):**
This file has sub-components (ConnectionCard, EmailRow, SearchSection) defined in the same file. Each needs `useLanguage()` since they are React components with access to context.

1. Add `import { useLanguage } from "../hooks/useLanguage.js";`
2. In the main `Integrations` component, add `const { t } = useLanguage();`
3. Replace in main component:
   - `"Integrations"` title -> `t("integrations.title")`
   - `"Loading integration status..."` -> `t("integrations.loading")`
   - Google connection card props:
     - `provider="Google (Gmail)"` -> `provider={t("integrations.provider_google")}`
     - `connectLabel="Connect Google"` -> `connectLabel={t("integrations.connect_google")}`
     - Connected detail: build dynamically using t() interpolation. Since the current code builds detail strings with conditionals and template literals, simplify: for connected state use a simple format like `t("integrations.status_connected")` plus optional email/date info built inline. For disconnected state use `t("integrations.google_disconnected_detail")`.
     - Approach for connected detail: Build the string parts conditionally but keep them simple: `const googleDetail = state?.google.connected ? \`${t("integrations.status_connected")}${state.google.email ? \` — ${state.google.email}\` : ""}${state.google.connectedAt ? \` (${new Date(state.google.connectedAt).toLocaleDateString()})\` : ""}\` : t("integrations.google_disconnected_detail");`
   - GitHub connection card: same pattern with github keys
   - `"AI Search"` section title in non-team case -> `t("integrations.search_title")`
   - `"Create a team to use AI-powered search..."` -> `t("integrations.search_no_team")`
   - `"Gmail Inbox"` titles -> `t("integrations.gmail_title")`
   - `"Connect your Google account above to view..."` gmail -> `t("integrations.gmail_not_connected")`
   - `"Calendar"` titles -> `t("integrations.calendar_title")`
   - `"View meetings from your Google Calendar..."` -> `t("integrations.calendar_description")`
   - `"Connect your Google account above to view calendar meetings."` -> `t("integrations.calendar_not_connected")`

4. In `ConnectionCard` sub-component, add `const { t } = useLanguage();`:
   - `"Connected"` -> `t("integrations.status_connected")`
   - `"Not connected"` -> `t("integrations.status_not_connected")`
   - `"Disconnecting..."` / `"Disconnect"` -> `t("integrations.disconnecting")` / `t("integrations.disconnect")`
   - `"Connecting..."` -> `t("integrations.connecting")`

5. In `SearchSection` sub-component, add `const { t } = useLanguage();`:
   - `"AI Search"` -> `t("integrations.search_title")`
   - `"Search across projects..."` -> `t("integrations.search_description")`
   - `"Ask anything about your projects..."` -> `t("integrations.search_placeholder")`
   - `"All"`, `"Projects"`, `"Ideas"`, `"Soul Docs"` options -> `t("integrations.search_scope_all")`, etc.
   - `"Searching..."` / `"Search"` -> `t("integrations.search_searching")` / `t("integrations.search_button")`
   - `"Answer:"` -> `t("integrations.search_answer")`
   - `"Sources (N):"` -> `t("integrations.search_sources", { count: searchResult.results.length })`

6. In `EmailRow` sub-component: only `"(no subject)"` needs translation -> add `const { t } = useLanguage();` and use `t("integrations.gmail_no_subject")`

7. In Gmail section of main component:
   - `"Filter (e.g., is:unread..."` -> `t("integrations.gmail_filter_placeholder")`
   - `"Loading..."` / `"Fetch Messages"` -> `t("integrations.gmail_fetch_loading")` / `t("integrations.gmail_fetch_button")`
   - `"No messages loaded..."` -> `t("integrations.gmail_empty")`

**CalendarWidget.tsx:**
1. Add `import { useLanguage } from "../hooks/useLanguage.js";`
2. In main `CalendarWidget` component, add `const { t } = useLanguage();`:
   - `"Calendar"` heading -> `t("calendar.title")`
   - `"No meetings found."` -> `t("calendar.empty")`
3. In `MeetingRow` sub-component, add `const { t } = useLanguage();`:
   - `"Linked"` badge -> `t("calendar.badge_linked")`
   - `"Upcoming"` badge -> `t("calendar.badge_upcoming")`
   - `attendees` count: `meeting.attendees.length !== 1 ? t("calendar.attendees_plural", { count: meeting.attendees.length }) : t("calendar.attendees", { count: meeting.attendees.length })`
   - `"Link to project"` -> `t("calendar.link_to_project")`
   - `"Select project..."` -> `t("calendar.select_project")`
   - `"Cancel"` -> `t("calendar.cancel")`

**IdeaRefinement.tsx:**
1. Add `import { useLanguage } from "../hooks/useLanguage.js";`
2. Add `const { t } = useLanguage();` at top of `IdeaRefinement` function body
3. Replace strings:
   - `"Readiness"` label -> `t("ideaRefinement.readiness")`
   - `"Threshold: N"` -> `t("ideaRefinement.threshold", { value: READINESS_THRESHOLD })`
   - `"Rounds: X/Y"` -> `t("ideaRefinement.rounds", { current: idea.refinementRounds, max: MAX_REFINEMENT_ROUNDS })`
   - `"(N left)"` suffix -> `roundsLeft > 0 ? t("ideaRefinement.rounds_left", { left: roundsLeft }) : ""`
   - `"Thinking..."` / `"Ask AI for Refinement Question"` -> `t("ideaRefinement.thinking")` / `t("ideaRefinement.ask_ai")`
   - `"Maximum refinement rounds reached (N)."` -> `t("ideaRefinement.max_rounds", { max: MAX_REFINEMENT_ROUNDS })`
   - `"AI Question"` -> `t("ideaRefinement.ai_question")`
   - `"Type your answer..."` -> `t("ideaRefinement.answer_placeholder")`
   - `"Cmd+Enter to submit"` -> `t("ideaRefinement.hint_submit")`
   - `"Submitting..."` / `"Submit Answer"` -> `t("ideaRefinement.submitting")` / `t("ideaRefinement.submit_answer")`
   - `"Readiness Assessment: N/100"` -> `t("ideaRefinement.assessment_header", { score: assessment.score })`
   - `"Missing Items:"` -> `t("ideaRefinement.missing_items")`
   - `"Overriding..."` / `"Mark as Ready (Override)"` -> `t("ideaRefinement.overriding")` / `t("ideaRefinement.override_button")`
   - Status info paragraph: `"This idea is currently in X status."` -> `t("ideaRefinement.status_info", { status: idea.status })` followed by conditional hint text using the appropriate key

IMPORTANT: Do NOT change any styling, logic, or component structure. Only replace string literals with t() calls. The Integrations.tsx file is large — be thorough but careful, touching only user-visible text.
  </action>
  <verify>Run `cd /Users/developer/eluma && npx tsc --noEmit` — no TypeScript errors. `grep -c "useLanguage" client/src/pages/Integrations.tsx client/src/components/CalendarWidget.tsx client/src/components/IdeaRefinement.tsx` — each file shows at least 1 match.</verify>
  <done>All three files import useLanguage, all user-facing strings use t() calls, TypeScript compiles without errors. No hardcoded English UI text remains in Integrations.tsx, CalendarWidget.tsx, or IdeaRefinement.tsx.</done>
</task>

</tasks>

<verification>
1. `cd /Users/developer/eluma && npx tsc --noEmit` passes with no errors
2. Both en.json and de.json parse as valid JSON
3. All three component files contain `useLanguage` import and `t()` calls
4. German translations use proper Unicode umlauts throughout
5. No hardcoded English UI strings in any of the three files
6. All sub-components within Integrations.tsx (ConnectionCard, EmailRow, SearchSection) also use t()
</verification>

<success_criteria>
- Integrations page shows all text in German when language is DE: page title, connection cards, search section, Gmail inbox, Calendar section
- CalendarWidget shows German badges (Verknüpft, Bevorstehend), attendee text, and link-to-project UI in German
- IdeaRefinement shows readiness labels, AI interaction UI, and status messages in German
- No hardcoded English strings remain in any of the three component files
- Both en.json and de.json are valid JSON with matching key structure
- TypeScript compilation passes
</success_criteria>

<output>
After completion, create `.planning/phases/10-client-i18n-coverage/10-04-SUMMARY.md`
</output>

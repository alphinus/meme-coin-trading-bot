---
phase: 02-project-lifecycle-dashboard
plan: 03
type: execute
wave: 3
depends_on: ["02-02"]
files_modified:
  - client/src/pages/ProjectDetail.tsx
  - client/src/components/PhaseTimeline.tsx
  - client/src/components/PhaseContent.tsx
  - client/src/components/RoiKpiCard.tsx
  - client/src/components/RoiKpiForm.tsx
  - client/src/i18n/locales/en.json
  - client/src/i18n/locales/de.json
  - client/src/App.tsx
autonomous: true

must_haves:
  truths:
    - "User can view a project's current phase and see all 8 phases in a horizontal timeline"
    - "Completed phases show a checkmark, current phase is highlighted, future phases are dimmed"
    - "User can fill in phase-specific data and advance to the next phase"
    - "User can add ROI/KPI entries with category, label, value, and unit"
    - "User can view ROI/KPI metrics broken down by phase and as totals"
    - "Advancing through review_extraction completes and archives the project"
  artifacts:
    - path: "client/src/pages/ProjectDetail.tsx"
      provides: "Single project view with phase timeline, content, and KPIs"
      exports: ["default"]
    - path: "client/src/components/PhaseTimeline.tsx"
      provides: "Horizontal 8-phase progress indicator"
      exports: ["PhaseTimeline"]
    - path: "client/src/components/PhaseContent.tsx"
      provides: "Phase-specific form/content area"
      exports: ["PhaseContent"]
    - path: "client/src/components/RoiKpiCard.tsx"
      provides: "ROI/KPI display card with per-phase breakdown"
      exports: ["RoiKpiCard"]
    - path: "client/src/components/RoiKpiForm.tsx"
      provides: "Form to add ROI/KPI entries"
      exports: ["RoiKpiForm"]
  key_links:
    - from: "client/src/pages/ProjectDetail.tsx"
      to: "client/src/hooks/useProject.ts"
      via: "useProject hook for project state and actions"
      pattern: "useProject"
    - from: "client/src/pages/ProjectDetail.tsx"
      to: "client/src/components/PhaseTimeline.tsx"
      via: "renders PhaseTimeline with project phases"
      pattern: "PhaseTimeline"
    - from: "client/src/components/PhaseContent.tsx"
      to: "useProject.advancePhase"
      via: "calls advancePhase on form submit"
      pattern: "advancePhase"
    - from: "client/src/components/RoiKpiForm.tsx"
      to: "useProject.addKpi"
      via: "calls addKpi on form submit"
      pattern: "addKpi"
---

<objective>
Build the project detail page with the 8-phase lifecycle timeline, phase-specific content forms, and ROI/KPI tracking UI. After this plan, users can navigate through all 8 project phases and track metrics.

Purpose: This is the core interaction model -- the mandatory 8-phase lifecycle with visible progress. Users must understand where a project stands, what data is needed for the current phase, and how metrics accumulate. This plan makes the lifecycle tangible.
Output: Fully interactive project detail page at /projects/:id with phase timeline, phase forms, phase advancement, and ROI/KPI entry/display.
</objective>

<execution_context>
@/Users/developer/.claude/get-shit-done/workflows/execute-plan.md
@/Users/developer/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-project-lifecycle-dashboard/02-RESEARCH.md
@.planning/phases/02-project-lifecycle-dashboard/02-02-SUMMARY.md
@eluma/client/src/hooks/useProject.ts
@eluma/client/src/hooks/useLanguage.ts
@eluma/client/src/App.tsx
@eluma/client/src/i18n/locales/en.json
@eluma/client/src/i18n/locales/de.json
@eluma/shared/types/models.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build PhaseTimeline and PhaseContent components</name>
  <files>
    client/src/components/PhaseTimeline.tsx
    client/src/components/PhaseContent.tsx
  </files>
  <action>
    1. Create client/src/components/PhaseTimeline.tsx:
       - Props: phases (PhaseData[]), currentPhase (ProjectPhase), onPhaseClick?: (phase: ProjectPhase) => void
       - Renders a horizontal progress bar showing all 8 phases from PROJECT_PHASES
       - Each phase is a step in the timeline:
         - Completed phases (have completedAt): filled circle with checkmark, solid connecting line, full-color label
         - Current phase (matches currentPhase): pulsing/highlighted circle, bold label, current indicator
         - Future phases: empty/dimmed circle, dashed connecting line, muted label
       - Phase labels use translated names via useLanguage (project.phase.idea, project.phase.feasibility, etc.)
       - Clicking a completed phase calls onPhaseClick to view its data (read-only)
       - Responsive: on narrow screens, abbreviate phase names or show as a vertical list
       - Inline CSS, clean and calm style, consistent with existing app aesthetic
       - Colors should be meaningful: green for completed, blue for current, gray for future

    2. Create client/src/components/PhaseContent.tsx:
       - Props: project (ProjectState), onAdvance (phaseData: Record<string, unknown>) => Promise<void>, isAdvancing (boolean)
       - Displays content/form for the current phase
       - Each phase gets a flexible form with:
         - A text area for notes/rationale (all phases have this)
         - Phase-specific suggested fields based on phase type:
           * idea: "Core idea", "Problem being solved", "Initial thoughts"
           * feasibility: "Technical feasibility", "Resource availability", "Timeline estimate"
           * effort_estimate: "Estimated hours", "Estimated cost (CHF)", "Required skills"
           * roi_kpi_initial: "Expected revenue impact", "Expected cost savings", "Success metrics" (note: this phase also suggests adding KPIs via the KPI form)
           * risks_dependencies: "Identified risks", "Dependencies on other projects/teams", "Mitigation strategies"
           * decision_point: "Go/No-Go rationale", "Conditions for proceeding", "Stakeholder input"
           * implementation: "Implementation progress notes", "Blockers encountered", "Milestones reached"
           * review_extraction: "Key learnings", "Patterns to replicate", "Patterns to avoid", "Final assessment"
         - These are all optional text fields -- the user can fill what they want. Use Record<string, unknown> to store.
       - "Complete Phase & Advance" button at bottom that calls onAdvance with collected phaseData
         - Button shows the next phase name: "Complete & advance to {nextPhaseName}"
         - If current phase is review_extraction, button says "Complete & Archive Project"
         - Button disabled while isAdvancing is true
       - If project.archived is true, show read-only view of the last phase data with "Project Archived" banner
       - For viewing completed phases (when user clicks a past phase in timeline): show the stored phaseData as read-only text
       - All labels translated via useLanguage
  </action>
  <verify>
    Run `cd /Users/developer/eluma && npx tsc --build --noEmit` -- compiles without errors.
    PhaseTimeline renders 8 steps with correct visual states.
    PhaseContent renders phase-specific form fields.
  </verify>
  <done>
    PhaseTimeline shows all 8 phases with visual distinction (completed/current/future). PhaseContent renders phase-appropriate form fields and an advance button. Both components use i18n translations.
  </done>
</task>

<task type="auto">
  <name>Task 2: Build ROI/KPI components and ProjectDetail page</name>
  <files>
    client/src/components/RoiKpiCard.tsx
    client/src/components/RoiKpiForm.tsx
    client/src/pages/ProjectDetail.tsx
    client/src/App.tsx
    client/src/i18n/locales/en.json
    client/src/i18n/locales/de.json
  </files>
  <action>
    1. Create client/src/components/RoiKpiCard.tsx:
       - Props: kpis (RoiKpiEntry[]), title?: string
       - Displays ROI/KPI entries in a card layout
       - Shows total summary at top: sum of values grouped by category+unit (e.g., "Revenue: 50000 EUR", "Time Saved: 120 hours")
       - Below summary, expandable per-phase breakdown:
         - Groups KPIs by phase
         - Each phase section shows its KPI entries as a simple table (label, value, unit, category)
       - If no KPIs, shows empty state message
       - Clean card with subtle border and shadow, consistent with app style
       - All text translated

    2. Create client/src/components/RoiKpiForm.tsx:
       - Props: onSubmit (category: string, label: string, value: number, unit: string, decisionId?: string) => Promise<void>, isSubmitting (boolean)
       - Compact inline form (not a modal) with fields:
         - Category: text input with datalist suggestions (revenue_impact, cost_savings, time_saved, risk_reduction, quality_improvement)
         - Label: text input (e.g., "Monthly subscription revenue")
         - Value: number input
         - Unit: text input with datalist suggestions (EUR, CHF, hours, percent, count)
         - Decision ID: optional text input (for linking to a specific decision)
       - Submit button: "Add KPI" / "KPI hinzufuegen"
       - Clears form on successful submit
       - All labels translated

    3. Create client/src/pages/ProjectDetail.tsx:
       - Uses useProject(projectId) hook -- gets projectId from useParams
       - Uses useProjects() for the project tabs at top (user can switch between projects)
       - Layout:
         - ProjectTabs at top (same tab bar as ProjectList page, showing all projects)
         - Project name and description below tabs (editable via inline edit or edit button -- simple, can use contentEditable or a toggle)
         - PhaseTimeline showing 8-phase progress
         - Two-column layout below timeline:
           * Left (wider): PhaseContent with current phase form
           * Right (narrower): RoiKpiCard showing project metrics + RoiKpiForm for adding KPIs
         - On mobile: single column, PhaseContent on top, KPIs below
       - Phase advancement flow:
         - User fills phase form fields
         - Clicks "Complete & Advance"
         - Calls useProject.advancePhase(phaseData)
         - On success, timeline updates to show new current phase
         - On error, shows error message
       - KPI addition flow:
         - User fills KPI form in sidebar
         - Clicks "Add KPI"
         - Calls useProject.addKpi(...)
         - On success, KPI card updates with new entry
       - Viewing past phases: clicking a completed phase in timeline shows its stored data in the PhaseContent area (read-only mode)
       - Handle loading, error, and not-found states

    4. Update client/src/App.tsx:
       - Replace the placeholder /projects/:id route with ProjectDetail component import and route

    5. Update i18n locale files (en.json and de.json) with all new keys:
       Phase content labels for each phase's fields (project.phase_form.idea.core_idea, etc.)
       - project.advance_button / Phase abschliessen & weiter / Complete & advance to {phase}
       - project.advance_archive / Abschliessen & Archivieren / Complete & Archive Project
       - project.archived_banner / Projekt archiviert / Project Archived
       - project.kpi.title / ROI/KPI Metriken / ROI/KPI Metrics
       - project.kpi.add_button / KPI hinzufuegen / Add KPI
       - project.kpi.category / Kategorie / Category
       - project.kpi.label / Bezeichnung / Label
       - project.kpi.value / Wert / Value
       - project.kpi.unit / Einheit / Unit
       - project.kpi.decision_id / Entscheidungs-ID / Decision ID
       - project.kpi.empty / Noch keine KPIs erfasst / No KPIs recorded yet
       - project.kpi.by_phase / Nach Phase / By phase
       - project.kpi.total / Gesamt / Total
       - project.detail.edit / Bearbeiten / Edit
       - project.detail.save / Speichern / Save
       - project.detail.not_found / Projekt nicht gefunden / Project not found
       - Suggested category translations (project.kpi.category.revenue_impact, etc.)
  </action>
  <verify>
    Run `cd /Users/developer/eluma && npx tsc --build --noEmit` -- compiles without errors.
    Start server and verify:
    1. Navigate to /projects/:id for an existing project -- see phase timeline and content
    2. Fill phase form and click advance -- project moves to next phase
    3. Add a KPI entry -- it appears in the KPI card
    4. Timeline updates correctly showing completed phases
    5. Both DE and EN translations work
  </verify>
  <done>
    ProjectDetail page renders at /projects/:id with phase timeline, phase-specific forms, and ROI/KPI sidebar. Users can advance through all 8 phases. KPI entries display per-phase and aggregated. Completing review_extraction archives the project. All text is translated in DE/EN.
  </done>
</task>

</tasks>

<verification>
- TypeScript compiles: `cd /Users/developer/eluma && npx tsc --build --noEmit`
- Project detail page renders with all components
- Full lifecycle can be traversed from idea to review_extraction
- Phase advancement updates timeline visually
- ROI/KPI entries can be added and display correctly
- Archived project shows read-only view
- All UI text available in DE and EN
</verification>

<success_criteria>
- Every project shows an 8-phase timeline with clear completed/current/future visual states
- Users can fill phase-specific forms and advance sequentially
- ROI/KPI entries can be added per phase and viewed in aggregate
- Project completing the final phase is archived and shows archived state
- All text is translated in German and English
</success_criteria>

<output>
After completion, create `.planning/phases/02-project-lifecycle-dashboard/02-03-SUMMARY.md`
</output>

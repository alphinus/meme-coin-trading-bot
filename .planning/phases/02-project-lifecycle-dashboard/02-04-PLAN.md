---
phase: 02-project-lifecycle-dashboard
plan: 04
type: execute
wave: 4
depends_on: ["02-03"]
files_modified:
  - client/src/components/StatusPieChart.tsx
  - client/src/components/ArchiveTab.tsx
  - client/src/hooks/useProjectMetrics.ts
  - client/src/pages/Dashboard.tsx
  - client/src/pages/ProjectList.tsx
  - client/src/i18n/locales/en.json
  - client/src/i18n/locales/de.json
autonomous: false

must_haves:
  truths:
    - "User can view a global overview dashboard with project status distribution pie chart"
    - "Pie chart shows how many projects are in each lifecycle phase"
    - "User can see aggregated ROI/KPI totals across all projects on the dashboard"
    - "Completed projects appear in a dedicated archive tab/view"
    - "Archive view shows archived projects with their final metrics"
  artifacts:
    - path: "client/src/components/StatusPieChart.tsx"
      provides: "Pie chart showing project status distribution"
      exports: ["StatusPieChart"]
    - path: "client/src/components/ArchiveTab.tsx"
      provides: "List of archived projects with summary data"
      exports: ["ArchiveTab"]
    - path: "client/src/hooks/useProjectMetrics.ts"
      provides: "Dashboard overview data fetching"
      exports: ["useProjectMetrics"]
    - path: "client/src/pages/Dashboard.tsx"
      provides: "Updated dashboard with project overview section"
      contains: "StatusPieChart"
  key_links:
    - from: "client/src/hooks/useProjectMetrics.ts"
      to: "/api/projects/dashboard/overview"
      via: "apiCall to dashboard overview endpoint"
      pattern: "apiCall.*dashboard/overview"
    - from: "client/src/components/StatusPieChart.tsx"
      to: "react-minimal-pie-chart"
      via: "PieChart component import"
      pattern: "import.*PieChart.*react-minimal-pie-chart"
    - from: "client/src/pages/Dashboard.tsx"
      to: "client/src/components/StatusPieChart.tsx"
      via: "renders StatusPieChart with distribution data"
      pattern: "StatusPieChart"
---

<objective>
Complete the Phase 2 user experience: install react-minimal-pie-chart, build the global dashboard overview with status distribution pie chart and aggregated ROI/KPI, build the archive view for completed projects, and verify the full Phase 2 experience end-to-end.

Purpose: This plan delivers the final two requirements (PROJ-06 archive tab, PROJ-07 global dashboard) and ties together the complete Phase 2 experience with a human verification checkpoint.
Output: Updated dashboard with project overview section, pie chart, archive tab, and verified end-to-end workflow.
</objective>

<execution_context>
@/Users/developer/.claude/get-shit-done/workflows/execute-plan.md
@/Users/developer/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-project-lifecycle-dashboard/02-RESEARCH.md
@.planning/phases/02-project-lifecycle-dashboard/02-03-SUMMARY.md
@eluma/client/src/pages/Dashboard.tsx
@eluma/client/src/pages/ProjectList.tsx
@eluma/client/src/api/client.ts
@eluma/client/src/hooks/useLanguage.ts
@eluma/client/src/i18n/locales/en.json
@eluma/client/src/i18n/locales/de.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install react-minimal-pie-chart and build dashboard overview components</name>
  <files>
    client/src/components/StatusPieChart.tsx
    client/src/hooks/useProjectMetrics.ts
    client/src/components/ArchiveTab.tsx
  </files>
  <action>
    1. Install react-minimal-pie-chart:
       `cd /Users/developer/eluma && npm install react-minimal-pie-chart -w client`

    2. Create client/src/hooks/useProjectMetrics.ts:
       - Fetches GET /api/projects/dashboard/overview via apiCall
       - State: overview ({ statusDistribution, aggregatedKpis, totalProjects, activeProjects, archivedProjects } | null), loading (boolean), error (string | null)
       - Returns: { overview, loading, error, refresh }
       - Auto-fetches on mount via useEffect

    3. Create client/src/components/StatusPieChart.tsx:
       - Import { PieChart } from "react-minimal-pie-chart"
       - Props: distribution (Record<string, number>)
       - Maps distribution entries to PieChart data format: { title, value, color }
       - Phase colors (research provides these):
         * idea: "#60a5fa", feasibility: "#34d399", effort_estimate: "#fbbf24"
         * roi_kpi_initial: "#f472b6", risks_dependencies: "#fb923c", decision_point: "#a78bfa"
         * implementation: "#2563eb", review_extraction: "#10b981", archived: "#9ca3af"
       - Renders as a donut chart (lineWidth={60}) with external labels showing phase name and count
       - Labels use translated phase names via useLanguage
       - Returns null if no data (empty distribution)
       - Style: height 250px, centered in its container
       - Include a legend below the chart mapping colors to phase names

    4. Create client/src/components/ArchiveTab.tsx:
       - Props: projects (ProjectState[]) -- pre-filtered to archived only
       - Renders a list/grid of archived project cards
       - Each card shows:
         * Project name
         * Description (truncated to 2 lines)
         * Completion date (updatedAt from last event)
         * Total KPI summary (values summed by category)
         * Number of phases completed (should always be 8)
       - Empty state: "No archived projects yet"
       - All text translated via useLanguage
       - Clean card design with subtle border, consistent with app style
  </action>
  <verify>
    Run `cd /Users/developer/eluma && npx tsc --build --noEmit` -- compiles without errors.
    Verify react-minimal-pie-chart is in client/package.json dependencies.
    StatusPieChart renders with sample data without crashing.
  </verify>
  <done>
    react-minimal-pie-chart installed. StatusPieChart renders a donut chart with phase-colored segments and legend. useProjectMetrics fetches dashboard overview data. ArchiveTab displays archived project cards with KPI summaries.
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate overview into Dashboard and wire archive into ProjectList</name>
  <files>
    client/src/pages/Dashboard.tsx
    client/src/pages/ProjectList.tsx
    client/src/i18n/locales/en.json
    client/src/i18n/locales/de.json
  </files>
  <action>
    1. Update client/src/pages/Dashboard.tsx (the /home page):
       - Keep existing welcome section with user name, team name, and language switcher
       - Keep existing two-column layout with TeamManager on left and ActivityFeed on right
       - ADD a new "Project Overview" section above or below the existing grid:
         * Section title: "Project Overview" / "Projektuebersicht"
         * Three summary cards in a row:
           - "Active Projects" with count (large number)
           - "Archived Projects" with count
           - "Total KPIs Tracked" with count of all KPI entries
         * StatusPieChart showing status distribution (only render if there are projects)
         * Aggregated KPI display: show summed values by category (e.g., "Revenue Impact: 50000 EUR") as simple metric cards
         * Link to /projects: "View all projects" / "Alle Projekte anzeigen"
       - Use useProjectMetrics hook for all data
       - If no projects exist, show a compact "Get started" prompt linking to /projects
       - Maintain the clean, calm aesthetic

    2. Update client/src/pages/ProjectList.tsx:
       - When user navigates to /projects/archive (or clicks the Archive tab):
         * Show ArchiveTab component with archived projects from useProjects().archived
         * ProjectTabs still visible at top, with Archive tab active/highlighted
       - Detect archive mode via useLocation or a URL segment check
       - Archive tab in ProjectTabs should link to /projects/archive

    3. Update i18n locale files with all remaining keys:
       - dashboard.project_overview / Projektuebersicht / Project Overview
       - dashboard.active_projects / Aktive Projekte / Active Projects
       - dashboard.archived_projects / Archivierte Projekte / Archived Projects
       - dashboard.total_kpis / Erfasste KPIs / Total KPIs Tracked
       - dashboard.view_all_projects / Alle Projekte anzeigen / View all projects
       - dashboard.get_started / Erstellen Sie Ihr erstes Projekt / Create your first project
       - project.archive.empty / Noch keine archivierten Projekte / No archived projects yet
       - project.archive.completed_on / Abgeschlossen am / Completed on
       - project.archive.phases_completed / Phasen abgeschlossen / Phases completed
       - Aggregated KPI labels if not already present
  </action>
  <verify>
    Run `cd /Users/developer/eluma && npx tsc --build --noEmit` -- compiles without errors.
    Start server and verify:
    1. Navigate to /home -- see project overview section with summary cards
    2. If projects exist, pie chart renders with correct phase distribution
    3. Navigate to /projects/archive -- see archived projects (or empty state)
    4. Both DE and EN translations work for all new sections
  </verify>
  <done>
    Dashboard at /home shows project overview section with summary cards, pie chart, and aggregated KPIs. ProjectList at /projects/archive shows archived projects via ArchiveTab. All new text is translated in DE/EN.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: End-to-end Phase 2 verification</name>
  <what-built>
    Complete project lifecycle management system:
    1. Project CRUD with team member assignment
    2. Browser-tab-like project navigation
    3. 8-phase mandatory lifecycle (Idea through Review & Pattern Extraction)
    4. Phase-specific forms with advance functionality
    5. ROI/KPI tracking per phase with aggregated views
    6. Auto-archive on lifecycle completion
    7. Global dashboard with pie chart and KPI overview
    8. Archive tab for completed projects
    9. Full DE/EN translation coverage
  </what-built>
  <how-to-verify>
    Start the app: `cd /Users/developer/eluma && npm run dev`

    1. **Project Creation (PROJ-01):**
       - Navigate to /projects
       - Click "+" or "New Project"
       - Fill in name: "Test Project Alpha", description: "Testing the lifecycle"
       - Select team members (if available)
       - Submit -- project should appear as a tab

    2. **Tab Navigation (PROJ-02):**
       - Create a second project: "Test Project Beta"
       - Both projects should appear as browser-like tabs
       - Click between tabs -- each navigates to correct project detail
       - Tab bar should be scrollable if tabs overflow

    3. **Phase Lifecycle (PROJ-03, PROJ-04):**
       - Open "Test Project Alpha"
       - Verify timeline shows 8 phases with "Idea" as current (highlighted)
       - Fill in some idea notes in the phase form
       - Click "Complete & advance to Feasibility"
       - Timeline should update: Idea gets checkmark, Feasibility is now current
       - Repeat advancement through all 8 phases (can leave forms mostly empty)
       - After completing "Review & Pattern Extraction", project should be archived

    4. **ROI/KPI Tracking (PROJ-05):**
       - Open "Test Project Beta" (still active)
       - Add a KPI: Category="revenue_impact", Label="Monthly revenue", Value=5000, Unit="CHF"
       - KPI should appear in the sidebar card
       - Advance to next phase, add another KPI
       - Verify KPIs show per-phase breakdown

    5. **Archive Tab (PROJ-06):**
       - "Test Project Alpha" (completed) should no longer appear in active tabs
       - Click "Archive" tab -- should show "Test Project Alpha" with its completion info

    6. **Dashboard Overview (PROJ-07):**
       - Navigate to /home
       - Project Overview section should show:
         * Active Projects: 1, Archived Projects: 1
         * Pie chart showing status distribution
         * Aggregated KPIs (the CHF entries from Beta)
       - "View all projects" link should work

    7. **Language Switch:**
       - Switch to German -- all new UI text should be in German
       - Phase names, buttons, labels, dashboard overview -- all translated
       - Switch back to English -- everything in English

    **Expected result:** All 7 requirements (PROJ-01 through PROJ-07) are working as described.
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe specific issues to fix</resume-signal>
</task>

</tasks>

<verification>
- All 7 PROJ requirements are met and verifiable through the UI
- TypeScript compiles cleanly
- No console errors in browser during normal usage
- Both DE and EN translations cover all new UI text
- Pie chart renders correctly with real project data
- Archive auto-triggers after completing the 8th phase
</verification>

<success_criteria>
- Dashboard shows project overview with pie chart and aggregated KPIs (PROJ-07)
- Archived projects appear in dedicated archive tab (PROJ-06)
- Full end-to-end lifecycle verified by human user
- All Phase 2 requirements (PROJ-01 through PROJ-07) satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/02-project-lifecycle-dashboard/02-04-SUMMARY.md`
</output>

---
phase: 02-project-lifecycle-dashboard
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - client/src/components/ProjectTabs.tsx
  - client/src/components/StatusPieChart.tsx
  - client/src/pages/Dashboard.tsx
  - client/src/i18n/locales/en.json
  - client/src/i18n/locales/de.json
  - client/package.json
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Active projects appear as horizontal browser-tab-like buttons above the project cards, with the current phase shown on each tab"
    - "Tabs scroll horizontally when there are many projects, with overflow-x: auto behavior"
    - "Clicking an active project tab navigates to /project/:id"
    - "Clicking the Archive tab navigates to /projects?view=archive"
    - "Dashboard shows a pie/donut chart visualizing the distribution of projects across lifecycle phases"
    - "Pie chart uses react-minimal-pie-chart with phase-appropriate colors and labels"
  artifacts:
    - path: "client/src/components/ProjectTabs.tsx"
      provides: "Horizontal tab bar component for browser-tab-like project navigation"
      min_lines: 60
    - path: "client/src/components/StatusPieChart.tsx"
      provides: "Pie chart component wrapping react-minimal-pie-chart for phase distribution"
      min_lines: 40
    - path: "client/src/pages/Dashboard.tsx"
      provides: "Dashboard integrating both ProjectTabs and StatusPieChart"
      contains: "ProjectTabs"
    - path: "client/package.json"
      provides: "react-minimal-pie-chart dependency"
      contains: "react-minimal-pie-chart"
  key_links:
    - from: "client/src/components/ProjectTabs.tsx"
      to: "navigate(/project/:id)"
      via: "onSelect callback on active tab click"
      pattern: "onSelect"
    - from: "client/src/components/ProjectTabs.tsx"
      to: "navigate(/projects?view=archive)"
      via: "onArchiveClick callback on archive tab click"
      pattern: "onArchiveClick"
    - from: "client/src/pages/Dashboard.tsx"
      to: "client/src/components/ProjectTabs.tsx"
      via: "handleTabSelect calls navigate(/project/:id), handleArchiveClick calls navigate(/projects?view=archive)"
      pattern: "handleTabSelect|handleArchiveClick"
    - from: "client/src/components/StatusPieChart.tsx"
      to: "DashboardOverview.statusDistribution"
      via: "distribution prop from useProjects overview"
      pattern: "distribution"
    - from: "client/src/pages/Dashboard.tsx"
      to: "client/src/components/StatusPieChart.tsx"
      via: "import and render with overview.statusDistribution prop"
      pattern: "StatusPieChart"
---

<objective>
Close two verification gaps from Phase 2: (1) implement browser-tab-like project navigation (PROJ-02), and (2) implement pie chart status distribution on the dashboard (PROJ-07). Also ensures archive tab navigation works (PROJ-06).

Purpose: Phase 2 verification found ProjectTabs and StatusPieChart components were never created despite being specified in plans 02-02 and 02-04. The backend data is already available (useProjects provides both project list and overview.statusDistribution). These are UI-only additions.

Output: Two new components (ProjectTabs.tsx, StatusPieChart.tsx) integrated into Dashboard.tsx, with react-minimal-pie-chart installed and i18n keys added for both languages.
</objective>

<execution_context>
@/Users/developer/.claude/get-shit-done/workflows/execute-plan.md
@/Users/developer/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-project-lifecycle-dashboard/02-VERIFICATION.md
@.planning/phases/02-project-lifecycle-dashboard/02-RESEARCH.md

# Source files to modify/reference
@client/src/pages/Dashboard.tsx
@client/src/components/ProjectList.tsx
@client/src/hooks/useProjects.ts
@client/src/i18n/locales/en.json
@client/src/i18n/locales/de.json
@client/package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ProjectTabs component and integrate into Dashboard</name>
  <files>
    client/src/components/ProjectTabs.tsx
    client/src/pages/Dashboard.tsx
    client/src/i18n/locales/en.json
    client/src/i18n/locales/de.json
  </files>
  <action>
Create `client/src/components/ProjectTabs.tsx` -- a horizontal browser-tab-like navigation bar for projects. This component was specified in Plan 02-02 but never implemented.

**ProjectTabs component requirements:**
- Accept props: `projects: ProjectState[]` (active projects), `archived: ProjectState[]`, `onSelect: (id: string) => void`, `onArchiveClick: () => void`
- Render a horizontal tab bar using inline CSS (consistent with project's styling approach -- no UI library)
- Each active project renders as a tab button showing: project name + small phase badge (use PHASE_CONFIG from ProjectList.tsx for phase colors)
- Active tab styling: slightly different background, bottom border highlight (like a browser tab)
- Tab container: `display: flex`, `overflow-x: auto`, `white-space: nowrap` on individual tabs, `flex-shrink: 0` per tab (per research pitfall #5 guidance)
- If archived projects exist, show an "Archive (N)" tab at the end, styled differently (muted/gray). Clicking this tab calls `onArchiveClick()` (NOT `onSelect`).
- Tab click on active projects calls `onSelect(projectId)` which the parent uses to navigate via `useNavigate`
- Import `useLanguage` for translating the archive tab label and phase names
- Use the same PHASE_CONFIG mapping already defined in ProjectList.tsx -- extract it to be importable, OR redefine it locally in ProjectTabs (simpler since it is a small const). Prefer redefining locally to avoid modifying ProjectList.tsx.

**Phase badge on tabs:** Show a small colored dot or short text label for the current phase next to the project name. Keep it compact since tabs have limited width.

**Tab bar container styles:**
```
tabBar: {
  display: 'flex',
  overflowX: 'auto',
  gap: '2px',
  borderBottom: '1px solid #e5e7eb',
  marginBottom: '1rem',
  paddingBottom: '0',
}
tab: {
  flexShrink: 0,
  padding: '0.5rem 1rem',
  border: '1px solid #e5e7eb',
  borderBottom: 'none',
  borderRadius: '6px 6px 0 0',
  backgroundColor: '#f9fafb',
  cursor: 'pointer',
  whiteSpace: 'nowrap',
  fontSize: '0.85rem',
  display: 'flex',
  alignItems: 'center',
  gap: '0.5rem',
}
activeTab: same as tab but backgroundColor: '#ffffff', fontWeight: 600, borderColor: '#d1d5db'
```

**Dashboard integration:**
- In `Dashboard.tsx`, import `ProjectTabs` and `useNavigate` from react-router-dom
- Render `<ProjectTabs>` ABOVE the existing `<ProjectList>` section, inside the `{team && ...}` block
- In Dashboard.tsx, create two handler functions:
  - `const handleTabSelect = (id: string) => navigate(`/project/${id}`)` -- wires active tab clicks to project detail navigation
  - `const handleArchiveClick = () => navigate('/projects?view=archive')` -- wires archive tab click to the project list page with archive view (the existing ProjectList page already shows archived projects)
- Pass all four props to ProjectTabs: `projects`, `archived`, `onSelect={handleTabSelect}`, `onArchiveClick={handleArchiveClick}`
- The existing ProjectList with cards remains below the tabs (tabs provide quick navigation, cards provide detail)

**i18n keys to add** (both en.json and de.json):
- `"dashboard.status_overview"`: "Status Overview" / "Statusuebersicht"
- `"dashboard.phase_distribution"`: "Phase Distribution" / "Phasenverteilung"
- `"project.archive_tab"`: "Archive" / "Archiv"

Do NOT modify `ProjectList.tsx` -- it stays as-is with the card layout.
  </action>
  <verify>
1. Run `npx tsc --noEmit -p client/tsconfig.json` from the project root -- no type errors in new files
2. Run `grep -c 'export' client/src/components/ProjectTabs.tsx` -- returns at least 1 (confirms file exists and exports a component)
3. Run `grep -q 'ProjectTabs' client/src/pages/Dashboard.tsx && echo 'PASS: Dashboard imports ProjectTabs'` -- confirms Dashboard imports and renders ProjectTabs
4. Run `grep -q 'handleTabSelect' client/src/pages/Dashboard.tsx && echo 'PASS: handleTabSelect exists'` -- confirms navigation handler is wired
5. Run `grep -q 'handleArchiveClick' client/src/pages/Dashboard.tsx && echo 'PASS: handleArchiveClick exists'` -- confirms archive navigation handler is wired
6. Run `grep -q 'onArchiveClick' client/src/components/ProjectTabs.tsx && echo 'PASS: onArchiveClick prop exists'` -- confirms archive click prop defined
7. Run `grep -q 'dashboard.phase_distribution' client/src/i18n/locales/en.json && grep -q 'dashboard.phase_distribution' client/src/i18n/locales/de.json && echo 'PASS: i18n keys present'`
  </verify>
  <done>
ProjectTabs component renders active projects as horizontal browser tabs with phase indicators. Tabs scroll horizontally on overflow. Archive tab appears when archived projects exist and navigates to /projects?view=archive on click. Active project tabs navigate to /project/:id. Dashboard renders ProjectTabs above the project cards section with both handleTabSelect and handleArchiveClick handlers wired. All text is translated in both languages.
  </done>
</task>

<task type="auto">
  <name>Task 2: Install react-minimal-pie-chart, create StatusPieChart, integrate into Dashboard</name>
  <files>
    client/package.json
    client/src/components/StatusPieChart.tsx
    client/src/pages/Dashboard.tsx
    client/src/i18n/locales/en.json
    client/src/i18n/locales/de.json
  </files>
  <action>
**Step 1: Install the library**
Run `npm install react-minimal-pie-chart@^9.1.2 -w client` from the project root (`/Users/developer/eluma`).

**Step 2: Create StatusPieChart component**
Create `client/src/components/StatusPieChart.tsx` following the research code example closely.

Requirements:
- Accept prop: `distribution: Record<string, number>` (phase name -> project count, from `overview.statusDistribution`)
- Use `PieChart` from `react-minimal-pie-chart`
- Define PHASE_COLORS mapping (from research):
  ```
  idea: "#60a5fa", feasibility: "#34d399", effort_estimate: "#fbbf24",
  roi_kpi_initial: "#f472b6", risks_dependencies: "#fb923c",
  decision_point: "#a78bfa", implementation: "#2563eb",
  review_extraction: "#10b981", archived: "#9ca3af"
  ```
- Map distribution entries to PieChart data format: `{ title, value, color }`
- Render as donut chart: `lineWidth={60}`, `paddingAngle={2}`
- Add external labels showing phase name and count: `labelPosition={112}`, `labelStyle={{ fontSize: '5px', fill: '#374151' }}`
- Wrap in a container with a title (use `t("dashboard.phase_distribution")`)
- If distribution is empty or has no entries, return null (no chart to show)
- Chart height: 250px via `style={{ height: '250px' }}`
- Use `useLanguage` to translate phase names in labels -- map phase keys through `t("project.phase_${key}")` for display. For "archived" use `t("project.archived")`.
- Add a simple legend below the chart: colored dots + phase name + count, laid out as a flex-wrap row

**Step 3: Integrate into Dashboard.tsx**
- Import `StatusPieChart`
- Add a new section between the welcome header and the project section (or between project section and the grid). Place it logically: after the welcome section but before the team/activity grid, alongside or above the project list.
- Best placement: Add StatusPieChart inside a new "Overview" row above the team/activity grid, only shown when `overview?.statusDistribution` has entries and `overview.totalProjects > 0`.
- Render: `<StatusPieChart distribution={overview.statusDistribution} />`

**Step 4: i18n keys** (add to both en.json and de.json, if not already added by Task 1):
- Ensure `"dashboard.status_overview"` and `"dashboard.phase_distribution"` exist from Task 1
- No additional keys needed beyond what Task 1 adds -- StatusPieChart reuses existing `project.phase_*` and `project.archived` keys for phase labels

**Important:** Dashboard.tsx is also modified by Task 1 (adding ProjectTabs). Since these tasks run sequentially in the same plan, Task 2 should read the file as modified by Task 1 before making changes. Both additions are in different sections of Dashboard.tsx so there is no conflict.
  </action>
  <verify>
1. Run `npm ls react-minimal-pie-chart -w client` -- confirms package is installed
2. Run `npx tsc --noEmit -p client/tsconfig.json` from project root -- no type errors
3. Run `grep -c 'export' client/src/components/StatusPieChart.tsx` -- returns at least 1 (confirms file exists and exports a component)
4. Run `grep -q 'StatusPieChart' client/src/pages/Dashboard.tsx && echo 'PASS: Dashboard imports StatusPieChart'` -- confirms Dashboard imports and conditionally renders StatusPieChart
5. Run `grep -q 'distribution' client/src/components/StatusPieChart.tsx && echo 'PASS: distribution prop used'` -- confirms component accepts distribution data
  </verify>
  <done>
react-minimal-pie-chart is installed. StatusPieChart renders a donut chart with phase-colored segments and a legend when projects exist. Dashboard shows the pie chart in the overview section. The chart correctly maps phase distribution data from the existing /api/projects/dashboard/overview endpoint. Labels use translated phase names.
  </done>
</task>

</tasks>

<verification>
1. TypeScript compilation: `npx tsc --noEmit -p client/tsconfig.json` passes with no errors
2. Dev server starts: `npm run dev` from project root loads without errors
3. Dashboard page renders ProjectTabs as horizontal tab bar above project cards
4. Dashboard page renders StatusPieChart donut when projects exist
5. ProjectTabs scroll horizontally when many tabs present (can verify with dev tools resize)
6. Clicking an active project tab navigates to /project/:id
7. Clicking the Archive tab navigates to /projects?view=archive
8. Both components use translated text (switch language to verify)
9. No regressions: existing project cards, team management, and activity feed still work
</verification>

<success_criteria>
- ProjectTabs.tsx exists and renders active projects as browser-tab-like horizontal buttons with phase indicators
- ProjectTabs accepts onArchiveClick prop and archive tab navigates to /projects?view=archive
- StatusPieChart.tsx exists and renders a donut chart from overview.statusDistribution data
- Dashboard.tsx imports and renders both new components with handleTabSelect and handleArchiveClick handlers
- react-minimal-pie-chart is in client/package.json dependencies
- i18n keys added to both en.json and de.json
- TypeScript compiles without errors
- PROJ-02 (browser-tab navigation) gap is closed
- PROJ-06 (archive tab) gap is closed
- PROJ-07 (pie chart visualization) gap is closed
</success_criteria>

<output>
After completion, create `.planning/phases/02-project-lifecycle-dashboard/02-05-SUMMARY.md`
</output>
